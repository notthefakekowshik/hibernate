package com.workfusion.serviceImpl;

import java.util.Scanner;

import com.workfusion.beans.Address;
import com.workfusion.beans.Customer;
import com.workfusion.exceptions.InvalidPhoneNumberException;
import com.workfusion.repository.CustomerRepository;
import com.workfusion.services.CustomerService;

public class CustomerServiceImpl implements CustomerService {

	Scanner scanner = new Scanner(System.in);
	Customer c = new Customer();
	CustomerRepository cr = new CustomerRepository();
    Address a = new Address();
	public void addNewCustomer() throws InvalidPhoneNumberException {
		// TODO Auto-generated method stub
		System.out.println("Enter your Name");
		c.setCustomerName(scanner.next());
		System.out.println("Enter your Mobile Number");
		Long phoneNumber = scanner.nextLong();
		if(String.valueOf(phoneNumber).length() != 10)
		{
			throw new InvalidPhoneNumberException("Invalid phone number");
		}
		else 
		{
			if(!(String.valueOf(phoneNumber).charAt(0) >= '6' && String.valueOf(phoneNumber).charAt(0) <= '9'))
			{
				throw new InvalidPhoneNumberException("Invalid phone number");
			}
			else
			{
				c.setCustomerPhone(scanner.nextLong());
			}
		}
		catch(InvalidPhoneNumberException e)
		{
			System.out.println(e.getMessage());
		}
		System.out.println("Enter your username");
		c.setCustomerUsername(scanner.next());
		
		
		System.out.println("Enter your password");
		c.setCustomerPassword(scanner.next());
		System.out.println("Enter your street");
		a.setStreet(scanner.next());
		System.out.println("Enter your city");
		a.setCity(scanner.next());
		System.out.println("Enter your Pincode");
	    a.setPincode(scanner.nextLong());
	    c.setAddress(a);
		try {
			cr.addNewCustomer(c);
			customerLogin();
		} catch (Exception e) {
			e.getMessage();
		}
	}

	public void updateCustomerDetails() {
		// TODO Auto-generated method stub

	}

	public void customerLogin() {
		// TODO Auto-generated method stub
		try {
			System.out.println("Enter your username");
			c.setCustomerUsername(scanner.next());
			System.out.println("Enter your password");
			c.setCustomerPassword(scanner.next());
			boolean flag=cr.customerLoginRepo(c);
			if(!flag) {
				customerLogin();
			}
		} catch (Exception e) {
			e.getMessage();
		}
	}



}
